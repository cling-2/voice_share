{% extends "layout.html" %}
{% block title %}我的足迹{% endblock %}

{% block content %}
<div class="records-page-wrapper">

  <section class="section-wrapper">
    <div class="section-header-modern">
      <h1><i class="ri-headphone-line"></i> 听歌足迹</h1>
      <p>记录你最近 30 天在这里留下的音乐感动。</p>
    </div>

    <div class="records-list-container">
      {% for record in listen_records %}
        <div class="record-item music-style">
          <div class="record-content-wrapper">
            <div class="record-icon-box">
              <i class="ri-disc-line"></i>
            </div>
            <div class="record-content">
              <div class="record-main-text" title="{{ record.song_name }}">{{ record.song_name }}</div>
              <div class="record-sub-text">
                <i class="ri-time-line"></i> {{ record.played_at.strftime('%Y-%m-%d %H:%M') }}
              </div>
            </div>
          </div>

          <div class="record-actions">
            <form method="post" action="{{ url_for('main.delete_listen_record', record_id=record.id) }}" onsubmit="return confirm('确认删除这条听歌记录吗？');">
              <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
              <button type="submit" class="delete-record-btn" title="删除记录">
                <i class="ri-close-line"></i>
              </button>
            </form>
          </div>

          <div class="record-decoration">
            <i class="ri-music-2-fill"></i>
          </div>
        </div>
      {% else %}
        <div class="empty-state-modern">
          <div class="empty-icon-box"><i class="ri-music-2-line"></i></div>
          <p>还没有听过歌，快去房间里点一首吧</p>
        </div>
      {% endfor %}
    </div>
  </section>

  <section class="section-wrapper">
    <div class="section-header-modern">
      <h1><i class="ri-footprint-line"></i> 访客记录</h1>
      <p>最近 30 天你探索过的所有房间。</p>
    </div>

    <div class="records-list-container">
      {% for record in room_records %}
        <div class="record-item room-style">
          <a href="{{ url_for('main.room_detail', code=record.room_code) }}" class="record-content-wrapper clickable-area">
            <div class="record-icon-box">
              <i class="ri-home-4-line"></i>
            </div>
            <div class="record-content">
              <div class="record-main-text">房间 #{{ record.room_code }}</div>
              <div class="record-sub-text">
                <i class="ri-calendar-event-line"></i> {{ record.participated_at.strftime('%Y-%m-%d %H:%M') }}
              </div>
            </div>
          </a>

          <div class="record-actions">
            <form method="post" action="{{ url_for('main.delete_room_record', record_id=record.id) }}" onsubmit="return confirm('确认删除这条访问记录吗？');">
              <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
              <button type="submit" class="delete-record-btn" title="删除记录">
                <i class="ri-close-line"></i>
              </button>
            </form>
          </div>
        </div>
      {% else %}
        <div class="empty-state-modern">
          <div class="empty-icon-box"><i class="ri-door-open-line"></i></div>
          <p>还没有访问过其他房间</p>
        </div>
      {% endfor %}
    </div>
  </section>

</div>
{% endblock %}